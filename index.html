<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>AngularJS and Flask sitting in a tree</title>

		<meta name="description" content="A presentation about building apps using AngularJS and Flask the simpler Python framework">
		<meta name="author" content="Andrew Lombardi">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="reveal.js/css/reveal.min.css">
		<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
		<link rel="stylesheet" href="css/reset.css">
		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

		<link rel="stylesheet" href="reveal.js-fullscreen-img/fullscreen-img.css" />

		<style>
			.button {
				-moz-box-shadow:inset 0px 1px 0px 0px #ffffff;
				-webkit-box-shadow:inset 0px 1px 0px 0px #ffffff;
				box-shadow:inset 0px 1px 0px 0px #ffffff;
				background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #ededed), color-stop(1, #dfdfdf) );
				background:-moz-linear-gradient( center top, #ededed 5%, #dfdfdf 100% );
				filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#ededed', endColorstr='#dfdfdf');
				background-color:#ededed;
				-moz-border-radius:6px;
				-webkit-border-radius:6px;
				border-radius:6px;
				border:1px solid #dcdcdc;
				display:inline-block;
				color:#777777;
				font-family:arial;
				font-size:15px;
				font-weight:bold;
				padding:6px 24px;
				text-decoration:none;
				text-shadow:1px 1px 0px #ffffff;
			}.button:hover {
				background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #dfdfdf), color-stop(1, #ededed) );
				background:-moz-linear-gradient( center top, #dfdfdf 5%, #ededed 100% );
				filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#dfdfdf', endColorstr='#ededed');
				background-color:#dfdfdf;
			}.button:active {
				position:relative;
				top:1px;
			}


			table { border-collapse: collapse;
			font-family: Futura, Arial, sans-serif; }
			.reveal th, td { padding: 1em; }
			.reveal th, .reveal thead { background: #000; color: #fff; border: 1px solid #fff; }
			/*.reveal tr:nth-child(odd) { background: #ccc; }*/
			.reveal tr:hover { background: #aaa; }
			.reveal td { border: 1px solid #777; }
			.reveal th { font-size: 0.75em;}
			.reveal td { font-size: 0.5em; font-weight: normal; padding: 1em;}
			.reveal table { border: 1px solid #777; }

		</style>

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<script>
			//document.write( '<link rel="stylesheet" href="reveal.js/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );


		</script>

		<!--[if lt IE 9]>
		<script src="reveal.js/lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">

				<section>
				<!-- add a flask and angularjs svg logo in here -->
				    <object type="image/svg+xml" width="300" height="300" data="images/HTML5-Logo.svg"></object>

					<h2>AngularJS and Flask sitting in a tree</h2>
					<p>
						<small><a href="http://mysticcoders.com">Andrew Lombardi</a> / <a href="http://twitter.com/kinabalu">@kinabalu</a></small>
					</p>
					<p>
						<small><a href="http://mysticcoders.com">Mystic Coders, LLC</a></small>
					</p>
				</section>

				<section>
					<section>
						<h2>About Me</h2>
						<img src="images/me_and_j.jpg" />
					</section>
					<section>
						<h2>About Me</h2>
						<p class="fragment">14 Years in Business</p>
						<p class="fragment">Software Consultants</p>
						<p class="fragment">International Speakers</p>
						<p class="fragment">Training</p>
						<p class="fragment">App Developer (Objective-C, Java, JavaScript, Python)</p>
						<p>&nbsp;</p>
						<p class="fragment"><strong>To our success!</strong></p>
					</section>
				</section>                
				<section fullscreen-img="images/rakia_63.png" />
					<aside class="notes">
						Known side effects: 
						- You may start to sing. 
						- You can't find your way home. 
						- It's possible you may forget your name and/or get lost in your own home. 
						- If you drink more than 1 liter you may collapse. The bulgarian term for this condition is "Ïèÿí íà ñâèíÿ" (transcription "Pian na svinia", meaning "Drunk like a pig").
						...oh, rakiq,oh holy martyr... (quote from a bulgarian rakia-dedicated song... actually most of the bulgarian popular music (a.k.a. chalga) is dedicated and/or result of this powerfull brew...)
					</aside>				
				</section>
                <section>
                    <h2>What we'll cover</h2>
                    <ul>
                        <li class="fragment">Installing Flask</li>
                        <li class="fragment">Writing RESTful API</li>
                        <li class="fragment">Kickstarting AngularJS</li>
                        <li class="fragment">Modules, Controllers, Services, and templates</li>
                    </ul>
                </section>
                <section>
                    <h2>Why Flask?</h2>
                    <ul>
                        <li class="fragment">Simple and extensible</li>
                        <li class="fragment">Add core functionality via extensions</li>
                        <li class="fragment">Endlessly customizable</li>
                    </ul>
                </section>  					
                <section>
                    <section>
                        <h2>Install flask</h2>
                        <p class="fragment">$ pip install Flask</p>
                        <p class="fragment">$ easy_install Flask</p>
                    </section>
                    <section>
                        <h2>First install virtualenv</h2>
                    </section>
                    <section>
                        <h2>Installing virtualenv</h2>
                        <pre><code class="bash">$ pip install virtualenv</code></pre>
                    </section>
                    <section>
                    <h2>Configuring virtualenv for example</h2>
<pre><code class="bash">$ virtualenv contalk
$ source contalk/bin/activate
$ pip install -U Flask</code></pre>
                    </section>
                    <section>
                        <h2>requirements.txt</h2>
<pre><code class="bash">
$ pip freeze > requirements.txt
$ cat requirements.txt
Flask==0.10.1
Flask-RESTful==0.2.12
</code></pre>
                    </section>
                    <section>
                        <h2>virtualenv Directory Structure</h2>
<pre><code class="bash">
.
└── contalk
    ├── bin
    ├── include
    │   └── python2.7
    └── lib
        └── python2.7
            └── site-packages
</code></pre>
                        <p class="fragment">Segmenting our dependencies and allow testing multiple python environments</p>
                        <aside class="notes">
                        Lots of reasons to hate virtualenv, pip, etc but we won't go into detail here.  This configuration will work.  Can be done with a true virtualized environment such as Docker.
                        </aside>
                    </section>
                </section>
                <section>
                    <h2>Hello World example</h2>
<pre><code class="python">
from flask import Flask

app = Flask(__name__)

@app.route('/hello')
def hello():
    return 'Hello, World!'

if __name__ == '__main__':
    app.run()
</code></pre>            
                    <p class="fragment">Save to <code>helloworld.py</code></p>
                    <p class="fragment"><code>$ python helloworld.py</code></p>
                    <p class="fragment"><a href="http://localhost:5000/hello">http://localhost:5000/hello</a></p>
                </section>
                <section>
                    <section>
                        <h2>Example: Conference Talk</h2>
                        <p><strong>ConTalk</strong> will be the example we'll use throughout this talk.  We'll build a RESTful API using Flask and use that API from AngularJS to build out a useful interface.</p>
                    </section>
                    <section>
                        <h2>Sample JSON Data</h2>
<pre><code class="json">
[{
  "id": 1,
  "name": "AngularJS and Flask sitting in a tree",
  "speaker": "Andrew Lombardi",
  "technology": "JavaScript, Python",
  "description": "An awesome talk about the JavaScript framework AngularJS and using it with Flask to build a RESTful service",
  "time": {
    "begin_time": "14:25",
    "end_time": "15:10"
  },
  "date": "2014-11-18"
},
{
  "id": 2,
  "name": "Simple API's with bottle.py",
  "speaker": "Andrew Lombardi",
  "technology": "Python",
  "description": "An awesome talk",
  "time": {
    "begin_time": "14:25",
    "end_time": "15:10"
  },
  "date": "2014-11-19"
}]
</code></pre>
                    </section>                        
                    <section>
                        <h2>Get list of talks</h2>
                        <p><code>GET /talks</code></p>
<pre><code class="python">
from flask import Flask, jsonify, request
from flask.ext.restful import Api, Resource

app = Flask(__name__)
api = Api(app)

class TalksAPI(Resource):
    def get(self):
        return jsonify({"data": talks})

api.add_resource(TalksAPI, '/api/talks', endpoint='talks')


if __name__ == '__main__':
    app.run(host='0.0.0.0', debug=True)
</code></pre>
                    </section>
                    <section>
                        <h2>Flask-Restful</h2>
                        <p>Lightweight abstraction for building a REST api</p>
                        <p>We're using a simple in-memory var <code>talks</code></p>
                        <p>Can integrate with any data source, SQLAlchemy, MongoEngine, etc</p>
                    </section>
                    <section>
                        <h2>Testing GET talks list</h2>   
<pre><code class="bash">
curl -i -X GET http://localhost:5000/api/talks
HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 727
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: HEAD, GET, POST, OPTIONS
Access-Control-Max-Age: 21600
Access-Control-Allow-Headers: ACCEPT, CONTENT-TYPE, X-REQUESTED-WITH
Server: Werkzeug/0.9.6 Python/2.7.6
Date: Tue, 18 Nov 2014 01:10:12 GMT

{"data": [{"date": "2014-11-18","description": "An awesome talk about the JavaScript framework AngularJS and using it with Flask to build a RESTful service","id": 1,"name": "AngularJS and Flask sitting in a tree","speaker": "Andrew Lombardi","technology": "JavaScript, Python","time": {"begin_time": "14:25","end_time": "15:10"}}]}
</code></pre>                                             
                    </section>
                    <section>
                        <h2>Adding a talk</h2>
                        <p><code>POST /talks</code></p>
<pre><code class="python">
import json, uuid

def post(self):
    json_data = json.loads(request.data)
    new_id = uuid.uuid4()
    json_data['id'] = new_id
    talks.append(json_data)
    return jsonify({"id": json_data['id']})
</code></pre>                        
                    </section>
                    <!--
                    <section>
                        <h2>curl -X POST</h2>
                    </section>
                    -->
                    <section>
                        <h2>What about PUT, PATCH, and DELETE?</h2>
                        <p>With <a href="http://flask-restful.readthedocs.org">Flask-Restful</a> if we don't define functions for handling HTTP methods, it
                        sends back a <code>405 Method Not Allowed</code></p>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Overview of REST</h2>                       
                    </section>
                    <section>
                        <h2>Nouns not verbs</h2>
                        <table width="100%">
                        <thead>
                            <th>Bad</th>
                            <th>Good</th>
                        </thead>
                        <tbody>
                        <tr>
                            <td>getTalks</td>
                            <td>GET /talks</td>
                        </tr>
                        <tr>
                            <td>addTalk</td>
                            <td>POST /talks</td>
                        </tr>
                        <tr>
                            <td>removeTalk</td>
                            <td>DELETE /talks/&lt;uuid&gt;</td>
                        </tr>
                        <tr>
                            <td>getTalk</td>
                            <td>GET /talks/&lt;uuid&gt;</td>
                        </tr>
                        </tbody>
                        </table>
                    </section>
                    <section>
                        <h2>HTTP methods = verbs</h2>
                        <p><a href="http://example.com/resources">http://example.com/resources</a></p>
                        <table width="100%">
                        <thead>
                            <th>Method</th>
                            <th>Action</th>
                        </thead>
                        <tbody>
                        <tr>
                            <td><h1>GET</h1></td>
                            <td>List the members of the collection</td>
                        </tr>
                        <tr>
                            <td><h1>PUT</h1></td>
                            <td>Replace the entire collection with another collection</td>
                        </tr>
                        <tr>
                            <td><h1>POST</h1></td>
                            <td>Create new entry in collection</td>
                        </tr>
                        <tr>
                            <td><h1>DELETE</h1></td>
                            <td>Delete the entire collection</td>
                        </tr>
                        </tbody>
                        </table>
                    </section>
                    <section>
                        <h2>HTTP methods = verbs</h2>
                        <p><a href="http://example.com/resources/42">http://example.com/resources/42</a></p>
                        <table width="100%">
                        <thead>
                            <th>Method</th>
                            <th>Action</th>
                        </thead>
                        <tbody>
                        <tr>
                            <td><h1>GET</h1></td>
                            <td>Return the referenced member of the collection</td>
                        </tr>
                        <tr>
                            <td><h1>PUT</h1></td>
                            <td>Create or update the referenced member of the collection</td>
                        </tr>
                        <tr>
                            <td><h1>POST</h1></td>
                            <td>Generally unused on specific members</td>
                        </tr>
                        <tr>
                            <td><h1>DELETE</h1></td>
                            <td>Delete the referenced member of collection</td>
                        </tr>
                        </tbody>
                        </table>
                    </section>                  
                    <section>
                        <h2>GET and POST constraints</h2>
                        <p>Sometimes, firewalls, proxies, or just sending a unique HTTP method via an HTTP form is not allowed</p>
                        <p>First we write a middleware to take <code>X-HTTP-Method-Override</code> and replace <code>REQUEST_METHOD</code> with that value</p>
<pre><code class="python">class HTTPMethodOverrideMiddleware(object):
    allowed_methods = frozenset([
        'GET',
        'HEAD',
        'POST',
        'DELETE',
        'PUT',
        'PATCH',
        'OPTIONS'
    ])
    bodyless_methods = frozenset(['GET', 'HEAD', 'OPTIONS', 'DELETE'])

    def __init__(self, app):
        self.app = app

    def __call__(self, environ, start_response):
        method = environ.get('HTTP_X_HTTP_METHOD_OVERRIDE', '').upper()
        if method in self.allowed_methods:
            method = method.encode('ascii', 'replace')
            environ['REQUEST_METHOD'] = method
        if method in self.bodyless_methods:
            environ['CONTENT_LENGTH'] = '0'
        return self.app(environ, start_response)</code></pre>
                    </section>
                    <section>
                        <h2>GET and POST constraints</h2>
                        <p>Here's a test using the middleware</p>
<pre><code class="python">from flask import Flask

app = Flask(__name__)
app.wsgi_app = HTTPMethodOverrideMiddleware(app.wsgi_app)</code></pre>
                    </section>
                </section>                
                <section>
                    <section>
                    <h2>Serving our API from different domain</h2>
                    </section>
                    <section>
                        <h2>CORS</h2>
                        <ul>
                            <li class="fragment"><strong>C . </strong>ross</li>
                            <li class="fragment"><strong>O . </strong>rigin</li>
                            <li class="fragment"><strong>R . </strong>esource</li>
                            <li class="fragment"><strong>S . </strong>haring</li>
                        </ul>
                    </section>
                    <section>
                        <h2>OPTIONS and preflight</h2>
                        <p class="fragment">More complex CORS request comes with preflight</p>
                        <ul>
                            <li class="fragment">Custom headers are used in the request</li>
                            <li class="fragment">An HTTP method other than GET, HEAD, or POST used</li>
                            <li class="fragment">POST used but Content-Type other than <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, <code>text/plain</code></li>
                        </ul>
                        <aside class="notes">
                        This was shown to be a problem and head scratcher because certain javascript libraries were sending a custom header 'X-Requested-With' when issuing a request and it triggered the preflight.
                        </aside>
                    </section>
                    <section>
                        <h2>CORS with Flask-Restful</h2>
<pre><code class="python">class MyAPI(Resource):
    def options(self):
        return ""

api.decorators = [cors.crossdomain(origin='*', 
                  headers=['accept', 'Content-Type', 'X-Requested-With'])]
api.add_resource(MyAPI, '/api/my', endpoint='my')

</code></pre>
                    </section>
                </section> 
                <section>
                    <section>
                        <h2>Member REST calls</h2>
                    </section>
                    <section>
                        <h2>Get referenced talk</h2>
                        <p><code>GET /talks/&lt;uuid&gt;</code></p>
<pre><code class="python">
    def get(self, id):
        for talk in talks:
            if str(talk['id']) == str(id):
                return jsonify(talk)
        abort(404)
</code></pre>
                    </section>
                    <section>
                        <h2>Update referenced talk</h2>
                        <p><code>PUT /talks/&lt;uuid&gt;</code></p>
<pre><code class="python">
    def put(self, id):
        for idx, talk in enumerate(talks):
            if str(talk['id']) == str(id):
                json_data = json.loads(request.data)
                json_data['id'] = id
                talks[referenced_talk_idx] = json_data
                return jsonify(json_data)
        abort(404)
        return
</code></pre>
                    </section>
                    <section>
                        <h2>Deleting referenced talk</h2>
                        <p><code>DELETE /talks/&lt;uuid&gt;</code></p>
<pre><code class="python">                        
    def delete(self, id):
        for idx, talk in enumerate(talks):
            if str(talk['id']) == str(id):
                del talks[referenced_talk_idx]
                return
        abort(404)
        return
</code></pre>
                    </section>
                </section>
                <section>
                    <h2>Integration with middleware</h2>
<pre><code class="python">
from cherrypy import wsgiserver
from app import app

d = wsgiserver.WSGIPathInfoDispatcher({'/': app})
server = wsgiserver.CherryPyWSGIServer(('0.0.0.0', 8080), d)

if __name__ == '__main__':
   try:
      server.start()
   except KeyboardInterrupt:
      server.stop()
</code></pre>               
                    <p class="fragment">Save as <code>server.py</code></p>
                    <p class="fragment"><code>$ python server.py</code></p>
                    <p class="fragment"><a href="http://localhost:8080/api/talks">http://localhost:8080/api/talks</a></p>
                    <aside class="notes">
                    Here we can talk through how to integrate Flask with cherrypy, etc.
                    </aside>
                </section>
                <section>
                    <h2>Why AngularJS?</h2>
                    <ul>
                        <li class="fragment">Extends the DOM -- designer friendly</li>
                        <li class="fragment">Leverages Dependency Injection</li>
                        <li class="fragment">Modularity</li>
                        <li class="fragment">Fully embraces testing</li>  
                    </ul>
                </section>
                <section>
                    <h2>AngularJS Feelings Over Time</h2>
                    <img src="images/feelings_about_angularjs_over_time.png" class="noborder" />
                </section>
                <section>
                    <h2>Hello, World Example</h2>
<pre><code class="html">
&lt;!DOCTYPE html&gt;
&lt;html ng-app&gt;
&lt;head&gt;
    <title>Hello World!</title>
    <script type="text/javascript"
        src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
&lt;/head&gt;
&lt;body&gt;

    Name: <input type="text" ng-model="name" />
    <h1>Hello {{ name }}</h1>

&lt;/body&gt;
&lt;/html&gt;
</code></pre>                    
                </section>
                <section>
                    <section>
                    <h2>Kickstart with ngbp</h2>
                    <p><a href="https://github.com/ngbp/ngbp">https://github.com/ngbp/ngbp</a></p>
                    <p>Provides a basic framework for kickstarting AngularJS projects.  Has an awesome directory structure
                    and bakes in:
                    <ul>
                        <li>Twitter Bootstrap</li>
                        <li>Angular UI</li>
                        <li>Angular Bootstrap</li>
                        <li>Font Awesome</li>
                        <li>Grunt</li>
                        <li>LESS</li>
                    </ul>
                    <aside class="notes">
                    Just clone and go
                    </aside>
                    </p>
                    </section>
                    <section>
                        <h2>ngbp directory structure</h2>
<pre><code class="bash">
ng-boilerplate/
  |- grunt-tasks/
  |- karma/
  |- src/
  |  |- app/
  |  |  |- &lt;app logic&gt;
  |  |- assets/
  |  |  |- &lt;static files&gt;
  |  |- common/
  |  |  |- &lt;reusable code&gt;
  |  |- less/
  |  |  |- main.less
  |- vendor/
  |  |- angular-bootstrap/
  |  |- bootstrap/
  |  |- placeholders/
  |- .bowerrc
  |- bower.json
  |- build.config.js
  |- Gruntfile.js
  |- module.prefix
  |- module.suffix
  |- package.json
</code></pre>
                    </section>                        
                </section>
                <section>
                    <section>
                        <h2>UI Routing</h2>
                        <ul>
                            <li><code>$route</code> and <code>ngRoute</code> = part of core</li>
                            <li>3rd-party <code>ui-router</code> = best</li>
                        </ul>
                    </section>
                    <section>
                        <h2>ui-router</h2>
                        <p>Show list of talks</p>
<pre><code class="javascript">.config(function config( $stateProvider ) {
    $stateProvider
        .state( 'talks', {
            url: '/talks',
            views: {
                "main": {
                    controller: 'TalksCtrl',
                    templateUrl: 'talks/talks.tpl.html'
                }
            },
            resolve: {
                talks: function(talksService){
                    return talksService.getTalks();
                }
            },
            data:{ pageTitle: 'Talks' }
    })
});</code></pre>                    
                    </section>
                    <section>
                        <h2>Talks List controller</h2>
<pre><code class="javascript">
.controller( 'TalksCtrl', function TalksCtrl( $scope, talks, talksService, ngTableParams ) {
      $scope.talks = talks;
      $scope.remove = function(selectedTalk) {
          selectedTalk.remove().then(function() {
              talksService.removeTalk(selectedTalk, $scope.talks);
          });
      };

      /* jshint ignore:start */
      $scope.tableParams = new ngTableParams({
          count: $scope.talks.length
      },{
          counts: []
      });
      /* jshint ignore:end */
})
</code></pre>                        
                    </section>
                    <section>
                        <h2>Talks List template</h2>
                        <p><code>talks.tpl.html</code></p>
<pre><code class="html"><button ui-sref="talksadd" class='btn btn-success'>Add Talk</button>
<table class="table table-striped table-bordered" ng-table="tableParams">
    <tbody>
        <tr ng-repeat="talk in talks">
            <td data-title="'Title'"><a ui-sref="talksview({talkID: talk.id})" >{{talk.name}}</a></td>
            <td data-title="'Speaker'">{{talk.speaker}}</td>
            <td data-title="'Date'">{{talk.date}}</td>
            <td data-title="'Actions'">
                  <button confirmed-click="remove(talk)" ng-confirm-click="Are you sure you want to delete this talk?" class="btn btn-danger">Delete</button>
            </td>
          </tr>
    </tbody>
</table></code></pre>                        
                    </section>
                </section>
                <section>
                    <section>
                        <h2>REST module</h2>
                        <ul>
                            <li>$http and $resource = part of core</li>
                            <li>3rd-party Restangular = best</li>
                        </ul>
                    </section>
                    <section>
                        <h2>Restangular</h2>
<pre><code class="javascript">
var talks = Restangular.all("talks").getList();
</code></pre>        
                        <p><code>GET /talks</code></p>                
                    </section>
                    <section>
                        <h2>Response Interceptor</h2>
<pre><code class="javascript">RestangularProvider.addResponseInterceptor(function(data, operation, what, url, response, deferred) {
  var extractedData;
  if (operation === "getList") {
      extractedData = data.data;
  } else {
      extractedData = data;
  }
  return extractedData;
});
</code></pre>                    
                    </section>                    
                </section>
                <section>
                    <section>
                        <h2>Our Angular Service</h2>
                        <p><code>GET /talks</code></p>
<pre><code class="javascript">.factory("talksService", function(Restangular){
    return {
        getTalks: function(){
            return Restangular.all("talks").getList();
        },
    };
})</code></pre>
                    </section>
                    <section>
                        <p><code>POST /talks</code></p>
<pre><code class="javascript">addTalk: function(talk) {
    return Restangular.all("talks")
        .post(talk);
}</code></pre>                
                    </section>
                    <section>
                        <p><code>DELETE /talks/&lt;uuid&gt;</code></p>
<pre><code class="javascript">removeTalk: function(selectedTalk, talks) {
    var index = talks.indexOf(selectedTalk);
    if(index > -1) {
        talks.splice(index, 1);
    }
},</code></pre>
                    </section>
                    <section>
                        <p><code>GET /talks/&lt;uuid&gt;</code></p>
<pre><code class="javascript">getTalk: function(id) {
    return Restangular.one("talks", id).get();
},</code></pre>
                    </section>
                    <section>
                        <p><code>PUT /talks/&lt;uuid&gt;</code></p>
<pre><code class="javascript">updateTalk: function(talk) {
    return talk.put();
},</code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>View Talk Route</h2>
<pre><code class="javascript">.state( 'talksview', {
    url: '/talks/view/:talkID',
    views: {
      "main": {
        controller: 'TalksViewCtrl',
        templateUrl: 'talks/talks-view.tpl.html'
      }
    },
    resolve: {
        talk: function(talksService, $stateParams) {
            return talksService.getTalk($stateParams.talkID);
        }
    },
    data:{ pageTitle: 'View Talk' }
  })</code></pre>                        
                    </section>
                    <section>                    
                        <h2>View Talk Controller</h2>
<pre><code class="javascript">.controller( 'TalksViewCtrl', function TalksViewCtrl( talk, $scope, $state, $stateParams ) {
    $scope.headerText = 'View Talk';
    $scope.id = $stateParams.talkID;
    $scope.talk = talk;
})</code></pre>
                    </section>
                    <section>
                        <h2>View Talk Template</h2>
                        <p><code>talks-view.tpl.html</code></p>
<pre><code class="html"><h1 class="page-header">
    {{ headerText }}
    <small>- <a ui-sref="talks({ talkID: talk.id })">Return to overview</a></small>
</h1>
<div class="pull-right">
    <button ui-sref="talksedit({ talkID: id })" class="btn btn-primary">Edit</button>
</div>
    ...
    <div class="panel-heading">
        <h4 class="panel-title">{{ talk.name }}</h4>
    </div>
    ...
</code></pre>                        
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Edit Talk Route</h2>
<pre><code class="javascript">.state( 'talksedit', {
    url: '/talks/edit/:talkID',
    views: {
      "main": {
        controller: 'TalksEditCtrl',
        templateUrl: 'talks/talks-edit.tpl.html'
      }
    },
    resolve: {
        talk: function(talksService, $stateParams) {
            return talksService.getTalk($stateParams.talkID);
        }
    },    
    data:{ pageTitle: 'Edit Talk' }
  })</code></pre>                        
                    </section>
                    <section>                    
                        <h2>Edit Talk Controller</h2>
<pre><code class="javascript">.controller( 'TalksEditCtrl', function TalksEditCtrl( talk, $scope, talksService, $state, $stateParams ) {
    $scope.headerText = 'Edit Talk';
    $scope.id = $stateParams.talkID;
    $scope.talk = talk;

    $scope.save = function(isValid) {
        talksService.updateTalk($scope.talk).then(function() {
            $state.go('talksview', {talkID: $scope.talk.id});          
        });
    };

    $scope.cancel = function() {
        $state.go('talksview', {talkID: $scope.id});
    };
})</code></pre>
                    </section>
                    <section>
                        <h2>Edit/Add Talk Template</h2>
                        <p><code>talks-edit.tpl.html</code></p>
<pre><code class="html">
<form name="talkForm" ng-submit="save(talkForm.$valid)" novalidate>
    <div class="form-group" data-ng-class="{ 'has-error' : talkForm.name.$invalid && !talkForm.name.$pristine }">
      <label for="name">Title</label>
      <input type="text" name="name" data-ng-model="talk.name" class="form-control" required />
      <p data-ng-show="talkForm.name.$invalid && !talkForm.name.$pristine" class="help-block">Title is required.</p>
    </div>
    ...

<div class="form-group">
    <button type="submit" class="btn btn-primary" data-ng-disabled="talkForm.$invalid">Save</button>
    <button class="btn btn-warning" ng-click="cancel()">Cancel</button>
</div>
</form>
</code></pre>                        
                    </section>
                    <section>
                        <h2>Add Talk Route</h2>
<pre><code class="javascript">.state( 'talksadd', {
    url: '/talks/add',
    views: {
      "main": {
        controller: 'TalksAddCtrl',
        templateUrl: 'talks/talks-edit.tpl.html'
      }
    },
    data:{ pageTitle: 'Add Talk' }
  })
  ;
})</code></pre>                        
                    </section>
                    <section>                    
                        <h2>Edit Talk Controller</h2>
<pre><code class="javascript">.controller( 'TalksAddCtrl', function TalksAddCtrl( $scope, talksService, $state ) {
    $scope.headerText = 'Add Talk';

    $scope.talk = {};

    $scope.save = function(isValid) {
        talksService.addTalk($scope.talk).then(function() {
            $state.go('talks');
        });
    };

    $scope.cancel = function() {
        $state.go('talks');
    };
})</code></pre>
                    </section>                    
                </section>       
                <section>
                    <h2>DEMO</h2>
                </section>         
                <section>
                    <h2>AngularJS 2</h2>
                    <p>And now, forget everything.</p>
                    <aside class="notes">
                    * Removes the idea of: Controllers, Directive Definition Object, $scope, angular.module, jqLite
                    * new template engine
                    * AtScript: superset of TypeScript 
                    </aside>
                </section>
				<section>
					<h2>Helpful Links</h2>
					<p><a href="https://angularjs.org">AngularJS Homepage</a></p>
                    <p><a href="http://angularjs.blogspot.com/">AngularJS Blog</a></p>
                    <p><a href="http://ngmodules.org/">Angular Modules</a></p>
                    <p><a href="http://ng-learn.org/">ngLearn.org</a></p>
				</section>
				<section>
					<h2>New WebSocket book</h2>
					<p><a href="http://bit.ly/lombardi_websocket_book">bit.ly/lombardi_websocket_book</a></p>
					<img src="images/WebSocket_comp.png" />
				</section>				
				<section>
					<h1>Q &amp; A</h1>
					<h3>Andrew Lombardi / <a href="http://www.twitter.com/kinabalu">@kinabalu</a></h3>
					<p>
						kinabalu @ <a href="irc://irc.freenode.net">irc://irc.freenode.net</a>
					</p>
					<p>
						<small>#javascript</small>
					</p>
					<p>
						<small><a href="http://kinabalu.github.io/angularjs_and_flask_presentation">http://kinabalu.github.io/angularjs_and_flask_presentation</a></small>
					</p>
				</section>

			</div>

		</div>

		<script src="reveal.js/lib/js/head.min.js"></script>
		<script src="reveal.js/js/reveal.min.js"></script>
		<script src="js/underscore-min.js"></script>
		<script>

			Reveal.addEventListener( 'slidechanged', function( event ) {
			    // event.previousSlide, event.currentSlide, event.indexh, event.indexv

				_.each(iframe_sections, function(id_name) {
					name = id_name['name'];
					url = id_name['url'];

				    if(event.previousSlide && event.previousSlide.getAttribute('id')==name) {
				    	document.getElementById(name+'_iframe').parentNode.removeChild(document.getElementById(name+'_iframe'));
					}

					if(event.currentSlide.getAttribute('id')==name) {
						var iframe = document.createElement("iframe");
						iframe.src = url;
						iframe.id = name+'_iframe';
						iframe.width = '100%';
						iframe.height = '100%';
						document.getElementById(name).appendChild(iframe);					
					}
				});
			} );			
			Reveal.addEventListener( 'overviewshown', function( event ) { 
			} );
		</script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'reveal.js/plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'reveal.js-fullscreen-img/fullscreen-img.js' }
					//{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

			/*
			var canvas = document.getElementById('mystic_logo');
			if (canvas.getContext) {
				alert('canvas');
				var context = canvas.getContext('2d');

				var myImage = new Image();
				myImage.onload = function() {
				  canvas.setAttribute('width', myImage.width);
				  canvas.setAttribute('height', myImage.height);
				  context.drawImage(myImage, 0, 0);
		          }
			}
			myImage.src = "images/mystic-logo-contracts.png";
			*/
		</script>

	</body>
</html>
